events {
    worker_connections 1024;
}

http {
    include mime.types;
    sendfile on;
    server {

        listen 8080;
        resolver 127.0.0.11;
        root /app;
        gzip_static on;

        location /api/ {
            if ($request_method = OPTIONS) {
                add_header Access-Control-Allow-Origin *;
                add_header Access-Control-Allow-Methods 'PUT, OPTIONS';
                add_header Access-Control-Allow-Headers 'Origin, X-Requested-With, Content-Type, Accept';
                add_header Content-Type text/plain;
                add_header Content-Length 0;
                return 204;
            }

            add_header Access-Control-Allow-Origin * always;
            add_header Access-Control-Allow-Methods 'PUT, OPTIONS' always;
            add_header Access-Control-Allow-Headers 'Origin, X-Requested-With, Content-Type, Accept' always;

            proxy_pass http://purchaser:8080/;
        }
    }
}